schema: '2.0'
stages:
  01_load_data:
    cmd: python src/01_load_and_save.py --config=params.yaml
    deps:
    - path: src/01_load_and_save.py
      md5: 7631ec42d54e94e3752c3d4307121796
      size: 2032
    params:
      params.yaml:
        s3_data_source.bucket_folder_name: waffer_batch_files
        s3_data_source.bucket_name: wafferbucket
        s3_data_source.region_name: ap-south-1
        s3_data_source.s3_folder_list:
        - waffer_batch_files
        s3_data_source.s3_root_folder_prefix: waffer
    outs:
    - path: artifacts/waffer_batch_files
      md5: e56894b0812b99797276021d14dbaf75.dir
      size: 13625126
      nfiles: 41
  02_validation:
    cmd: python src/02_validation.py --config=params.yaml --schema=schema.yaml
    deps:
    - path: artifacts/waffer_batch_files
      md5: e56894b0812b99797276021d14dbaf75.dir
      size: 13625126
      nfiles: 41
    - path: src/02_validation.py
      md5: 9a34ef51a66d6f2ec7be4c6d62a8cd5d
      size: 6024
    params:
      params.yaml:
        artifacts.02_validation.bad_files_dir: artifacts/02_validation/bad_files
        artifacts.02_validation.good_files_dir: artifacts/02_validation/good_files
        artifacts.02_validation.s3_data_dir: artifacts/waffer_batch_files
      schema.yaml:
        LengthOfDateStampInFile: 8
        LengthOfTimeStampInFile: 6
        NumberofColumns: 592
    outs:
    - path: artifacts/02_validation/bad_files
      md5: 930fdd03dce096ddc5f3f5f3ba954977.dir
      size: 10726994
      nfiles: 32
    - path: artifacts/02_validation/good_files
      md5: afabd4473b9fadae1b2bb83b7df72e58.dir
      size: 3036137
      nfiles: 9
  03_preprocess:
    cmd: python src/03_preprocess.py --config=params.yaml
    deps:
    - path: artifacts/02_validation/good_files
      md5: afabd4473b9fadae1b2bb83b7df72e58.dir
      size: 3036137
      nfiles: 9
    - path: src/03_preprocess.py
      md5: cfcc97a1cb3b088dda24ec57d5782d74
      size: 6643
    params:
      params.yaml:
        artifacts.03_preprocess.null_cols_fname: null_values.csv
        artifacts.03_preprocess.preprocess_dir: artifacts/03_preprocess
        artifacts.03_preprocess.preprocessed_files: artifacts/03_preprocess/preprocessed_files
        hyperparams.KNNImputer.n_neighbors: 3
        hyperparams.KNNImputer.weights: uniform
    outs:
    - path: artifacts/03_preprocess/preprocessed_files
      md5: e31766ef9fbd992c8414c63e91149244.dir
      size: 1741791
      nfiles: 2
  04_split_data:
    cmd: python src/04_split_data.py --config=params.yaml
    deps:
    - path: artifacts/03_preprocess/preprocessed_files
      md5: e31766ef9fbd992c8414c63e91149244.dir
      size: 1741791
      nfiles: 2
    - path: src/04_split_data.py
      md5: fbac06f1b855537e9dd249543ee0b278
      size: 1973
    params:
      params.yaml:
        artifacts.04_split_data.split_data_dir: artifacts/04_split_data
        base.random_state:
        - 34
        base.test_size: 0.2
    outs:
    - path: artifacts/04_split_data/X_test.csv
      md5: b5a7bb5c8b6d85362d6c85c6f338e20d
      size: 347870
    - path: artifacts/04_split_data/X_train.csv
      md5: 0f18d6f8bd47e7e2d99a11e458c7a04f
      size: 1379069
    - path: artifacts/04_split_data/Y_test.csv
      md5: c8d3cd8e951b560777ec8ce3c0be7ba9
      size: 507
    - path: artifacts/04_split_data/Y_train.csv
      md5: cd624b8fa97a5a20b4e47266ce64b961
      size: 2007
  05_train:
    cmd: python src/05_train.py --config=params.yaml
    deps:
    - path: artifacts/04_split_data/X_train.csv
      md5: 0f18d6f8bd47e7e2d99a11e458c7a04f
      size: 1379069
    - path: artifacts/04_split_data/Y_train.csv
      md5: cd624b8fa97a5a20b4e47266ce64b961
      size: 2007
    - path: src/05_train.py
      md5: fd5a9dbf536ce9defd6186b5d7589c02
      size: 9468
    params:
      params.yaml:
        base.random_state:
        - 34
        hyperparams.balanced_bagging_classifer:
          model_name: bbc_model.sav
          cv: 10
          verbose: 3
          n_estimators:
          - 150
          - 200
          sampling_strategy:
          - 0.5
          - 1.0
          - 0.75
          replacement:
          - true
          - false
        hyperparams.balanced_random_forest:
          model_name: brfc_model.sav
          cv: 10
          verbose: 3
          n_estimators:
          - 300
          - 350
          - 500
          criterion:
          - gini
          - entropy
          max_depth:
          - 2
          - 5
          - 1
          max_features:
          - auto
          - log2
        hyperparams.easy_ensemble_classifier:
          model_name: eec_model.sav
          cv: 10
          verbose: 3
          n_estimators:
          - 150
          - 200
          sampling_strategy:
          - 0.5
          - 1.0
          - 0.75
          replacement:
          - true
          - false
    outs:
    - path: artifacts/05_train/bbc_model.sav
      md5: 36a4c2b9f3416a350365f51831824c2e
      size: 577551
    - path: artifacts/05_train/brfc_model.sav
      md5: baf315960b91084652d0feca1aee7dfc
      size: 1169917
    - path: artifacts/05_train/eec_model.sav
      md5: 7d86d6df4a76472ffecc59880ba14439
      size: 8050929
