schema: '2.0'
stages:
  01_load_data:
    cmd: python src/01_load_and_save.py --config=params.yaml
    deps:
    - path: src/01_load_and_save.py
      md5: 7631ec42d54e94e3752c3d4307121796
      size: 2032
    params:
      params.yaml:
        s3_data_source.bucket_folder_name: waffer_batch_files
        s3_data_source.bucket_name: wafferbucket
        s3_data_source.region_name: ap-south-1
        s3_data_source.s3_folder_list:
        - waffer_batch_files
        s3_data_source.s3_root_folder_prefix: waffer
    outs:
    - path: artifacts/waffer_batch_files
      md5: e56894b0812b99797276021d14dbaf75.dir
      size: 13625126
      nfiles: 41
  02_validation:
    cmd: python src/02_validation.py --config=params.yaml --schema=schema.yaml
    deps:
    - path: artifacts/waffer_batch_files
      md5: e56894b0812b99797276021d14dbaf75.dir
      size: 13625126
      nfiles: 41
    - path: src/02_validation.py
      md5: 9a34ef51a66d6f2ec7be4c6d62a8cd5d
      size: 6024
    params:
      params.yaml:
        artifacts.02_validation.bad_files_dir: artifacts/02_validation/bad_files
        artifacts.02_validation.good_files_dir: artifacts/02_validation/good_files
        artifacts.02_validation.s3_data_dir: artifacts/waffer_batch_files
      schema.yaml:
        LengthOfDateStampInFile: 8
        LengthOfTimeStampInFile: 6
        NumberofColumns: 592
    outs:
    - path: artifacts/02_validation/bad_files
      md5: 930fdd03dce096ddc5f3f5f3ba954977.dir
      size: 10726994
      nfiles: 32
    - path: artifacts/02_validation/good_files
      md5: afabd4473b9fadae1b2bb83b7df72e58.dir
      size: 3036137
      nfiles: 9
  03_preprocess:
    cmd: python src/03_preprocess.py --config=params.yaml
    deps:
    - path: artifacts/02_validation/good_files
      md5: afabd4473b9fadae1b2bb83b7df72e58.dir
      size: 3036137
      nfiles: 9
    - path: src/03_preprocess.py
      md5: 3e1cebaf6d1143ee849a299b59864e1c
      size: 5729
    params:
      params.yaml:
        artifacts.03_preprocess.null_cols_fname: null_values.csv
        artifacts.03_preprocess.preprocess_dir: artifacts/03_preprocess
        artifacts.03_preprocess.preprocessed_files: artifacts/03_preprocess/preprocessed_files
        hyperparams.KNNImputer.n_neighbors: 3
        hyperparams.KNNImputer.weights: uniform
    outs:
    - path: artifacts/03_preprocess/preprocessed_files
      md5: ee37eaebd0200e72460236d9d95b60c9.dir
      size: 2996317
      nfiles: 18
  04_split_data:
    cmd: python src/04_split_data.py --config=params.yaml
    deps:
    - path: artifacts/03_preprocess/preprocessed_files
      md5: ee37eaebd0200e72460236d9d95b60c9.dir
      size: 2996317
      nfiles: 18
    - path: src/04_split_data.py
      md5: 207dfa36c228e9aca4da9e61dcc3429c
      size: 2423
    params:
      params.yaml:
        artifacts.04_split_data.split_data_sir: artifacts/04_split_data
        artifacts.04_split_data.x_test_dir: artifacts/04_split_data/x_test
        artifacts.04_split_data.x_train_dir: artifacts/04_split_data/x_train
        artifacts.04_split_data.y_test_dir: artifacts/04_split_data/y_test
        artifacts.04_split_data.y_train_dir: artifacts/04_split_data/y_train
        base.random_state: 34
        base.test_size: 0.2
    outs:
    - path: artifacts/04_split_data/x_test
      md5: 5b3545665c3a7b4af8a17919974c0fa6.dir
      size: 631617
      nfiles: 9
    - path: artifacts/04_split_data/x_train
      md5: d9067d25586460feb3a8e5e1b9cc86f0.dir
      size: 2381047
      nfiles: 9
    - path: artifacts/04_split_data/y_test
      md5: 79c23710c255328d3fefbe980e70ac9c.dir
      size: 1344
      nfiles: 9
    - path: artifacts/04_split_data/y_train
      md5: 5cdf272ca44b3e556ec5197a5a17e5ff.dir
      size: 4766
      nfiles: 9
